/* esm.sh - esbuild bundle(lightningcss-wasm@1.22.0) esnext production */
import{Environment as Q,napi as K}from"./napi-wasm.mjs";var F;function E(e,t,n){F(e,t,n)}var x={None:0,Unwinding:1,Rewinding:2};function T(e){let{instance:t,exports:n}=e,{asyncify_get_state:a,asyncify_start_unwind:r,asyncify_stop_unwind:l,asyncify_start_rewind:o,asyncify_stop_rewind:s}=t.exports,i=t.exports.napi_wasm_malloc(8+4096),f=i+8,u=i+8+4096;new Int32Array(e.memory.buffer,i).set([f,u]);function y(){if(a()!==x.None)throw new Error(`Invalid async state ${a()}, expected 0.`)}let A,b,m;return F=(R,h,d)=>{if(a()===x.Rewinding){s(),b!=null&&e.createValue(b,h),m!=null&&e.createValue(m,d),A=b=m=null;return}y(),A=e.get(R),r(i)},async function(h){y();let d=n.bundle(h);for(;a()===x.Unwinding;){l();try{b=await A}catch(V){m=V}y(),o(i),d=n.bundle(h)}return y(),d}}var U={and_chr:"chrome",and_ff:"firefox",ie_mob:"ie",op_mob:"opera",and_qq:null,and_uc:null,baidu:null,bb:null,kaios:null,op_mini:null};function W(e){let t={};for(let n of e){let[a,r]=n.split(" ");if(U[a]===null)continue;let l=O(r);l!=null&&(t[a]==null||l<t[a])&&(t[a]=l)}return t}function O(e){let[t,n=0,a=0]=e.split("-")[0].split(".").map(r=>parseInt(r,10));return isNaN(t)||isNaN(n)||isNaN(a)?null:t<<16|n<<8|a}var P={Nesting:1,NotSelectorList:2,DirSelector:4,LangSelectorList:8,IsSelector:16,TextDecorationThicknessPercent:32,MediaIntervalSyntax:64,MediaRangeSyntax:128,CustomMediaQueries:256,ClampFunction:512,ColorFunction:1024,OklabColors:2048,LabColors:4096,P3Colors:8192,HexAlphaColors:16384,SpaceSeparatedColorNotation:32768,FontFamilySystemUi:65536,DoublePositionGradients:131072,VendorPrefixes:262144,LogicalProperties:524288,Selectors:31,MediaQueries:448,Colors:64512};function q(e){if(e.length===1)return e[0];let t={};return w(t,e,"Rule",N,C),w(t,e,"RuleExit",N,C),w(t,e,"Declaration",D,I),w(t,e,"DeclarationExit",D,I),c(t,e,"Url"),c(t,e,"Color"),c(t,e,"Image"),c(t,e,"ImageExit"),c(t,e,"Length"),c(t,e,"Angle"),c(t,e,"Ratio"),c(t,e,"Resolution"),c(t,e,"Time"),c(t,e,"CustomIdent"),c(t,e,"DashedIdent"),_(t,e,"MediaQuery"),_(t,e,"MediaQueryExit"),c(t,e,"SupportsCondition"),c(t,e,"SupportsConditionExit"),_(t,e,"Selector"),p(t,e,"Token","token",!1),p(t,e,"Function","function",!1),p(t,e,"FunctionExit","function",!0),p(t,e,"Variable","var",!1),p(t,e,"VariableExit","var",!0),p(t,e,"EnvironmentVariable","env",!1),p(t,e,"EnvironmentVariableExit","env",!0),t}function C(e,t){return e==="unknown"?n=>t({type:"unknown",value:n}):t}function I(e,t){return e==="custom"?n=>t({property:"custom",value:n}):t}function N(e,t){if(typeof e=="object"){if(t.type==="unknown"){let n=e.unknown;return typeof n=="object"&&(n=n[t.value.name]),n?.(t.value)}return e[t.type]?.(t)}return e?.(t)}function D(e,t){if(typeof e=="object"){let n=t.property;if(t.property==="unparsed")n=t.value.propertyId.property;else if(t.property==="custom"){let a=e.custom;return typeof a=="object"&&(a=a[t.value.name]),a?.(t.value)}return e[n]?.(t)}return e?.(t)}function M(e,t){let n=[],a=!1,r=new Set;for(let l of e){let o=l[t];if(o){if(typeof o=="function")a=!0;else for(let s in o)r.add(s);n.push(o)}}return[n,a,r]}function w(e,t,n,a,r){let[l,o,s]=M(t,n);if(l.length===0)return;if(l.length===1){e[n]=l[0];return}let i=k(t,(f,u)=>a(f[n],u));if(o)e[n]=i;else{let f={};for(let u of s)f[u]=r(u,i);e[n]=f}}function p(e,t,n,a,r){let[l,o,s]=M(t,n);if(l.length===0)return;if(l.length===1){e[n]=l[0];return}let i=B(t,a,r);if(o)e[n]=i;else{let f={};for(let u of s)f[u]=i;e[n]=f}}function B(e,t,n){let a=k(e,(r,l)=>{let o;switch(l.type){case"token":o=r.Token,typeof o=="object"&&(o=o[l.value.type]);break;case"function":o=n?r.FunctionExit:r.Function,typeof o=="object"&&(o=o[l.value.name]);break;case"var":o=n?r.VariableExit:r.Variable;break;case"env":if(o=n?r.EnvironmentVariableExit:r.EnvironmentVariable,typeof o=="object"){let i;switch(l.value.name.type){case"ua":case"unknown":i=l.value.name.value;break;case"custom":i=l.value.name.ident;break}o=o[i]}break;case"color":o=r.Color;break;case"url":o=r.Url;break;case"length":o=r.Length;break;case"angle":o=r.Angle;break;case"time":o=r.Time;break;case"resolution":o=r.Resolution;break;case"dashed-ident":o=r.DashedIdent;break}if(!o)return;let s=o(l.value);switch(l.type){case"color":case"url":case"length":case"angle":case"time":case"resolution":case"dashed-ident":Array.isArray(s)?s=s.map(i=>({type:l.type,value:i})):s&&(s={type:l.type,value:s});break}return s});return r=>a({type:t,value:r})}function j(e,t){let n=[];for(let a of e){let r=a[t];r&&n.push(r)}return n}function c(e,t,n){let a=j(t,n);if(a.length!==0){if(a.length===1){e[n]=a[0];return}e[n]=r=>{let l=!1;for(let o of a){let s=o(r);s&&(r=s,l=!0)}return l?r:void 0}}}function _(e,t,n){let a=j(t,n);if(a.length!==0){if(a.length===1){e[n]=a[0];return}e[n]=k(a,(r,l)=>r(l))}}function k(e,t){let n=new S(e.length);return a=>{let r=[a],l=!1;n.clear();for(let o=0;o<r.length;o++)for(let s=0;s<e.length;){if(n.get(s)){s++;continue}let i=r[o],f=e[s],u=t(f,i);Array.isArray(u)?(u.length===0?r.splice(o,1):u.length===1?r[o]=u[0]:r.splice(o,1,...u),l=!0,n.set(s),s=0):u?(r[o]=u,l=!0,n.set(s),s=0):s++}if(l)return r.length===1?r[0]:r}}var S=class{constructor(t=32){this.bits=0,this.more=t>32?new Uint32Array(Math.ceil((t-32)/32)):null}get(t){if(t>=32&&this.more){let n=Math.floor((t-32)/32),a=t%32;return!!(this.more[n]&1<<a)}else return!!(this.bits&1<<t)}set(t){if(t>=32&&this.more){let n=Math.floor((t-32)/32),a=t%32;this.more[n]|=1<<a}else this.bits|=1<<t}clear(){this.bits=0,this.more&&this.more.fill(0)}};var g,L;async function G(e){e=e??new URL("lightningcss_node.wasm",import.meta.url),(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=$(e));let{instance:t}=await H(await e,{env:{...K,await_promise_sync:E}}),n=new Q(t);g=n.exports,L=T(n)}function ee(e){return g.transform(e)}function te(e){return g.transformStyleAttribute(e)}function ne(e){return g.bundle(e)}function re(e){return L(e)}async function H(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(a){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",a);else throw a}let n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{let n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}async function $(e){try{return(await import("/v133/node_fs.js")).readFileSync(e)}catch{return fetch(e)}}export{P as Features,W as browserslistToTargets,ne as bundle,re as bundleAsync,q as composeVisitors,G as default,ee as transform,te as transformStyleAttribute};
//# sourceMappingURL=lightningcss-wasm.mjs.map